<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleanup Pro - ì‚¬ì§„ ì •ë¦¬ ì•±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0;
            background: white;
            border-radius: 20px 20px 0 0;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 20px 20px 0 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            display: block;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #eee;
            overflow-x: auto;
            position: sticky;
            top: 80px;
            z-index: 90;
        }

        .tab {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .tab.active {
            border-bottom-color: #667eea;
            color: #667eea;
            background: #f8f9ff;
        }

        .tab:hover {
            background: #f5f5f5;
        }

        .tab-content {
            display: none;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            padding: 20px 0;
        }

        .photo-item {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .photo-item:hover {
            transform: scale(1.05);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-select {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: 2px solid #ddd;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .photo-select.selected {
            background: #667eea;
            border-color: #667eea;
            color: white;
        }

        .photo-select::after {
            content: 'âœ“';
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .photo-select.selected::after {
            opacity: 1;
        }

        .duplicate-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background: #ff4757;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .tinder-container {
            max-width: 400px;
            margin: 0 auto;
            height: 600px;
            position: relative;
            perspective: 1000px;
        }

        .tinder-card {
            position: absolute;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: grab;
            overflow: hidden;
            transform-origin: center bottom;
            transition: transform 0.3s ease;
        }

        .tinder-card:active {
            cursor: grabbing;
        }

        .tinder-card img {
            width: 100%;
            height: 70%;
            object-fit: cover;
        }

        .tinder-card-info {
            padding: 20px;
            text-align: center;
        }

        .tinder-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .action-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .action-btn.delete {
            background: #ff4757;
            color: white;
        }

        .action-btn.keep {
            background: #2ed573;
            color: white;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #ff4757;
            color: white;
        }

        .btn-danger:hover {
            background: #ff3742;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #2ed573;
            color: white;
        }

        .btn-success:hover {
            background: #26d566;
            transform: translateY(-2px);
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #eee;
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            flex-direction: column;
            gap: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2ed573;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(0);
        }

        .trash-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .trash-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 15px;
        }

        .trash-item-info {
            flex: 1;
        }

        .trash-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }
            
            .header {
                border-radius: 0;
                padding: 15px;
            }
            
            .stats-dashboard {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                padding: 15px;
            }
            
            .photos-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 8px;
            }
            
            .tinder-container {
                height: 500px;
                margin: 0 10px;
            }
        }

        .swipe-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .swipe-hint.delete {
            background: rgba(255, 71, 87, 0.9);
        }

        .swipe-hint.keep {
            background: rgba(46, 213, 115, 0.9);
        }

        .infinite-scroll-trigger {
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .category-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding: 0 0 10px 0;
        }

        .category-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .category-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“¸ Cleanup Pro</h1>
            <p>ìŠ¤ë§ˆíŠ¸ ì‚¬ì§„ ì •ë¦¬ & ê´€ë¦¬ ë„êµ¬</p>
        </div>

        <div class="stats-dashboard">
            <div class="stat-card">
                <span class="stat-number" id="totalPhotos">0</span>
                <div class="stat-label">ì „ì²´ ì‚¬ì§„</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="duplicatePhotos">0</span>
                <div class="stat-label">ì¤‘ë³µ ì‚¬ì§„</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="blurryPhotos">0</span>
                <div class="stat-label">íë¦¿í•œ ì‚¬ì§„</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="trashCount">0</span>
                <div class="stat-label">íœ´ì§€í†µ</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('dashboard')">ëŒ€ì‹œë³´ë“œ</div>
            <div class="tab" onclick="switchTab('all-photos')">ì „ì²´ ì‚¬ì§„</div>
            <div class="tab" onclick="switchTab('duplicates')">ì¤‘ë³µ ì‚¬ì§„</div>
            <div class="tab" onclick="switchTab('tinder')">ìŠ¤ì™€ì´í”„ ì •ë¦¬</div>
            <div class="tab" onclick="switchTab('trash')">íœ´ì§€í†µ</div>
        </div>

        <div id="dashboard" class="tab-content active">
            <div class="controls">
                <button class="btn btn-primary" onclick="loadPhotos()">ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <button class="btn btn-danger" onclick="findDuplicates()">ì¤‘ë³µ ì‚¬ì§„ ì°¾ê¸°</button>
                <button class="btn btn-success" onclick="findBlurryPhotos()">íë¦¿í•œ ì‚¬ì§„ ì°¾ê¸°</button>
            </div>
            
            <div id="scanProgress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p id="progressText">ìŠ¤ìº” ì¤‘...</p>
            </div>

            <div id="dashboardContent">
                <div class="empty-state">
                    <h3>ğŸ“± ì‚¬ì§„ì„ ë¶ˆëŸ¬ì™€ì„œ ì‹œì‘í•˜ì„¸ìš”</h3>
                    <p>ìµœëŒ€ 30,000ì¥ê¹Œì§€ ì§€ì›í•˜ë©°, ì¤‘ë³µ ì‚¬ì§„ê³¼ íë¦¿í•œ ì‚¬ì§„ì„ ìë™ìœ¼ë¡œ ê°ì§€í•©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <div id="all-photos" class="tab-content">
            <div class="controls">
                <select class="filter-select" id="sortFilter" onchange="sortPhotos()">
                    <option value="date-desc">ìµœì‹  ìˆœ</option>
                    <option value="date-asc">ì˜¤ë˜ëœ ìˆœ</option>
                    <option value="size-desc">í° íŒŒì¼ ìˆœ</option>
                    <option value="size-asc">ì‘ì€ íŒŒì¼ ìˆœ</option>
                </select>
                <button class="btn btn-danger" onclick="deleteSelectedPhotos()">ì„ íƒ ì‚­ì œ</button>
                <button class="btn btn-primary" onclick="selectAllPhotos()">ì „ì²´ ì„ íƒ</button>
            </div>
            
            <div class="photos-grid" id="allPhotosGrid"></div>
            <div class="infinite-scroll-trigger" id="infiniteScrollTrigger">
                <div class="spinner" style="display: none;"></div>
            </div>
        </div>

        <div id="duplicates" class="tab-content">
            <div class="controls">
                <button class="btn btn-danger" onclick="autoDeleteDuplicates()">ìë™ ì •ë¦¬</button>
                <button class="btn btn-primary" onclick="selectAllDuplicates()">ì „ì²´ ì„ íƒ</button>
            </div>
            
            <div class="photos-grid" id="duplicatesGrid"></div>
        </div>

        <div id="tinder" class="tab-content">
            <div class="category-filter">
                <button class="category-btn active" onclick="setTinderFilter('all')">ì „ì²´</button>
                <button class="category-btn" onclick="setTinderFilter('duplicates')">ì¤‘ë³µ ì‚¬ì§„</button>
                <button class="category-btn" onclick="setTinderFilter('blurry')">íë¦¿í•œ ì‚¬ì§„</button>
                <button class="category-btn" onclick="setTinderFilter('screenshots')">ìŠ¤í¬ë¦°ìƒ·</button>
                <button class="category-btn" onclick="setTinderFilter('large')">í° íŒŒì¼</button>
            </div>
            
            <div class="tinder-container" id="tinderContainer">
                <div id="tinderEmpty" class="empty-state">
                    <h3>ğŸ‰ ëª¨ë“  ì‚¬ì§„ ì •ë¦¬ ì™„ë£Œ!</h3>
                    <p>ì •ë¦¬í•  ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <div class="tinder-actions">
                <button class="action-btn delete" onclick="swipeDelete()">ğŸ—‘ï¸</button>
                <button class="action-btn keep" onclick="swipeKeep()">â¤ï¸</button>
            </div>
        </div>

        <div id="trash" class="tab-content">
            <div class="controls">
                <button class="btn btn-success" onclick="restoreAllFromTrash()">ì „ì²´ ë³µì›</button>
                <button class="btn btn-danger" onclick="emptyTrash()">íœ´ì§€í†µ ë¹„ìš°ê¸°</button>
            </div>
            
            <div id="trashItems"></div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let allPhotos = [];
        let duplicatePhotos = [];
        let blurryPhotos = [];
        let trashItems = [];
        let tinderCards = [];
        let currentTinderFilter = 'all';
        let selectedPhotos = new Set();
        let currentPhotoIndex = 0;
        let isLoading = false;
        const PHOTOS_PER_PAGE = 50;

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // íƒ­ë³„ ì´ˆê¸°í™”
            if (tabName === 'tinder') {
                initializeTinderCards();
            } else if (tabName === 'all-photos') {
                displayAllPhotos();
            } else if (tabName === 'duplicates') {
                displayDuplicates();
            } else if (tabName === 'trash') {
                displayTrash();
            }
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            document.getElementById('totalPhotos').textContent = allPhotos.length;
            document.getElementById('duplicatePhotos').textContent = duplicatePhotos.length;
            document.getElementById('blurryPhotos').textContent = blurryPhotos.length;
            document.getElementById('trashCount').textContent = trashItems.length;
        }

        // ë”ë¯¸ ì‚¬ì§„ ë°ì´í„° ìƒì„± (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” File API ì‚¬ìš©)
        function generateDummyPhotos(count = 100) {
            const photos = [];
            const categories = ['portrait', 'landscape', 'nature', 'city', 'food', 'animals'];
            
            for (let i = 0; i < count; i++) {
                const category = categories[Math.floor(Math.random() * categories.length)];
                const id = `photo_${Date.now()}_${i}`;
                
                photos.push({
                    id: id,
                    url: `https://picsum.photos/400/400?random=${i}&category=${category}`,
                    name: `IMG_${String(i + 1).padStart(4, '0')}.jpg`,
                    size: Math.floor(Math.random() * 5000000) + 500000, // 0.5MB - 5.5MB
                    date: new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000),
                    category: category,
                    isDuplicate: Math.random() < 0.15, // 15% ì¤‘ë³µ
                    isBlurry: Math.random() < 0.1, // 10% íë¦¿í•¨
                    isScreenshot: Math.random() < 0.05, // 5% ìŠ¤í¬ë¦°ìƒ·
                });
            }
            
            return photos;
        }

        // ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadPhotos() {
            showProgressBar();
            
            try {
                // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì—¬ê¸°ì„œ File API ë˜ëŠ” ì›¹ APIë¥¼ ì‚¬ìš©
                await simulateProgress();
                allPhotos = generateDummyPhotos(Math.floor(Math.random() * 500) + 100);
                
                showToast('ì‚¬ì§„ì„ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
                updateStats();
                
            } catch (error) {
                showToast('ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideProgressBar();
            }
        }

        // ì¤‘ë³µ ì‚¬ì§„ ì°¾ê¸°
        async function findDuplicates() {
            if (allPhotos.length === 0) {
                showToast('ë¨¼ì € ì‚¬ì§„ì„ ë¶ˆëŸ¬ì™€ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            showProgressBar();
            
            try {
                await simulateProgress();
                duplicatePhotos = allPhotos.filter(photo => photo.isDuplicate);
                
                showToast(`${duplicatePhotos.length}ê°œì˜ ì¤‘ë³µ ì‚¬ì§„ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤!`);
                updateStats();
                
            } catch (error) {
                showToast('ì¤‘ë³µ ì‚¬ì§„ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideProgressBar();
            }
        }

        // íë¦¿í•œ ì‚¬ì§„ ì°¾ê¸°
        async function findBlurryPhotos() {
            if (allPhotos.length === 0) {
                showToast('ë¨¼ì € ì‚¬ì§„ì„ ë¶ˆëŸ¬ì™€ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            showProgressBar();
            
            try {
                await simulateProgress();
                blurryPhotos = allPhotos.filter(photo => photo.isBlurry);
                
                showToast(`${blurryPhotos.length}ê°œì˜ íë¦¿í•œ ì‚¬ì§„ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤!`);
                updateStats();
                
            } catch (error) {
                showToast('íë¦¿í•œ ì‚¬ì§„ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideProgressBar();
            }
        }

        // ì§„í–‰ë¥  í‘œì‹œ
        function showProgressBar() {
            document.getElementById('scanProgress').style.display = 'block';
        }

        function hideProgressBar() {
            document.getElementById('scanProgress').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
        }

        async function simulateProgress() {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            for (let i = 0; i <= 100; i += 10) {
                progressFill.style.width = i + '%';
                progressText.textContent = `ì²˜ë¦¬ ì¤‘... ${i}%`;
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        // ì „ì²´ ì‚¬ì§„ í‘œì‹œ
        function displayAllPhotos() {
            const grid = document.getElementById('allPhotosGrid');
            grid.innerHTML = '';
            
            const photosToShow = allPhotos.slice(0, PHOTOS_PER_PAGE);
            
            photosToShow.forEach(photo => {
                const photoDiv = document.createElement('div');
                photoDiv.className = 'photo-item';
                photoDiv.innerHTML = `
                    <img src="${photo.url}" alt="${photo.name}" loading="lazy">
                    <div class="photo-select ${selectedPhotos.has(photo.id) ? 'selected' : ''}" 
                         onclick="togglePhotoSelection('${photo.id}')"></div>
                    ${photo.isDuplicate ? '<div class="duplicate-badge">ì¤‘ë³µ</div>' : ''}
                `;
                grid.appendChild(photoDiv);
            });
            
            setupInfiniteScroll();
        }

        // ë¬´í•œ ìŠ¤í¬ë¡¤ ì„¤ì •
        function setupInfiniteScroll() {
            const trigger = document.getElementById('infiniteScrollTrigger');
            const observer = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting && !isLoading) {
                    loadMorePhotos();
                }
            });
            
            observer.observe(trigger);
        }

        // ë” ë§ì€ ì‚¬ì§„ ë¡œë“œ
        function loadMorePhotos() {
            if (currentPhotoIndex >= allPhotos.length) return;
            
            isLoading = true;
            const spinner = document.querySelector('#infiniteScrollTrigger .spinner');
            spinner.style.display = 'block';
            
            setTimeout(() => {
                const grid = document.getElementById('allPhotosGrid');
                const nextPhotos = allPhotos.slice(currentPhotoIndex, currentPhotoIndex + PHOTOS_PER_PAGE);
                
                nextPhotos.forEach(photo => {
                    const photoDiv = document.createElement('div');
                    photoDiv.className = 'photo-item';
                    photoDiv.innerHTML = `
                        <img src="${photo.url}" alt="${photo.name}" loading="lazy">
                        <div class="photo-select ${selectedPhotos.has(photo.id) ? 'selected' : ''}" 
                             onclick="togglePhotoSelection('${photo.id}')"></div>
                        ${photo.isDuplicate ? '<div class="duplicate-badge">ì¤‘ë³µ</div>' : ''}
                    `;
                    grid.appendChild(photoDiv);
                });
                
                currentPhotoIndex += PHOTOS_PER_PAGE;
                spinner.style.display = 'none';
                isLoading = false;
            }, 500);
        }

        // ì‚¬ì§„ ì„ íƒ í† ê¸€
        function togglePhotoSelection(photoId) {
            if (selectedPhotos.has(photoId)) {
                selectedPhotos.delete(photoId);
            } else {
                selectedPhotos.add(photoId);
            }
            
            // UI ì—…ë°ì´íŠ¸
            const selectElement = document.querySelector(`[onclick="togglePhotoSelection('${photoId}')"]`);
            if (selectElement) {
                selectElement.classList.toggle('selected', selectedPhotos.has(photoId));
            }
        }

        // ëª¨ë“  ì‚¬ì§„ ì„ íƒ
        function selectAllPhotos() {
            allPhotos.forEach(photo => selectedPhotos.add(photo.id));
            document.querySelectorAll('.photo-select').forEach(el => el.classList.add('selected'));
            showToast('ëª¨ë“  ì‚¬ì§„ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.');
        }

        // ì„ íƒëœ ì‚¬ì§„ ì‚­ì œ
        function deleteSelectedPhotos() {
            if (selectedPhotos.size === 0) {
                showToast('ì‚­ì œí•  ì‚¬ì§„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            const selectedArray = Array.from(selectedPhotos);
            const photosToDelete = allPhotos.filter(photo => selectedPhotos.has(photo.id));
            
            // íœ´ì§€í†µìœ¼ë¡œ ì´ë™
            trashItems.push(...photosToDelete);
            
            // ì›ë³¸ ë°°ì—´ì—ì„œ ì œê±°
            allPhotos = allPhotos.filter(photo => !selectedPhotos.has(photo.id));
            duplicatePhotos = duplicatePhotos.filter(photo => !selectedPhotos.has(photo.id));
            blurryPhotos = blurryPhotos.filter(photo => !selectedPhotos.has(photo.id));
            
            selectedPhotos.clear();
            updateStats();
            displayAllPhotos();
            
            showToast(`${selectedArray.length}ê°œ ì‚¬ì§„ì„ íœ´ì§€í†µìœ¼ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤.`);
        }

        // ì‚¬ì§„ ì •ë ¬
        function sortPhotos() {
            const sortType = document.getElementById('sortFilter').value;
            
            switch(sortType) {
                case 'date-desc':
                    allPhotos.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'date-asc':
                    allPhotos.sort((a, b) => new Date(a.date) - new Date(b.date));
                    break;
                case 'size-desc':
                    allPhotos.sort((a, b) => b.size - a.size);
                    break;
                case 'size-asc':
                    allPhotos.sort((a, b) => a.size - b.size);
                    break;
            }
            
            currentPhotoIndex = 0;
            displayAllPhotos();
        }

        // ì¤‘ë³µ ì‚¬ì§„ í‘œì‹œ
        function displayDuplicates() {
            const grid = document.getElementById('duplicatesGrid');
            grid.innerHTML = '';
            
            if (duplicatePhotos.length === 0) {
                grid.innerHTML = '<div class="empty-state"><h3>ì¤‘ë³µ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤</h3><p>ì¤‘ë³µ ì‚¬ì§„ ìŠ¤ìº”ì„ ì‹¤í–‰í•´ë³´ì„¸ìš”.</p></div>';
                return;
            }
            
            duplicatePhotos.forEach(photo => {
                const photoDiv = document.createElement('div');
                photoDiv.className = 'photo-item';
                photoDiv.innerHTML = `
                    <img src="${photo.url}" alt="${photo.name}" loading="lazy">
                    <div class="photo-select ${selectedPhotos.has(photo.id) ? 'selected' : ''}" 
                         onclick="togglePhotoSelection('${photo.id}')"></div>
                    <div class="duplicate-badge">ì¤‘ë³µ</div>
                `;
                grid.appendChild(photoDiv);
            });
        }

        // ëª¨ë“  ì¤‘ë³µ ì‚¬ì§„ ì„ íƒ
        function selectAllDuplicates() {
            duplicatePhotos.forEach(photo => selectedPhotos.add(photo.id));
            document.querySelectorAll('#duplicatesGrid .photo-select').forEach(el => el.classList.add('selected'));
            showToast('ëª¨ë“  ì¤‘ë³µ ì‚¬ì§„ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.');
        }

        // ìë™ ì¤‘ë³µ ì œê±°
        function autoDeleteDuplicates() {
            if (duplicatePhotos.length === 0) {
                showToast('ì¤‘ë³µ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            // íœ´ì§€í†µìœ¼ë¡œ ì´ë™
            trashItems.push(...duplicatePhotos);
            
            // ì›ë³¸ ë°°ì—´ì—ì„œ ì œê±°
            allPhotos = allPhotos.filter(photo => !photo.isDuplicate);
            const deletedCount = duplicatePhotos.length;
            duplicatePhotos = [];
            
            updateStats();
            displayDuplicates();
            
            showToast(`${deletedCount}ê°œì˜ ì¤‘ë³µ ì‚¬ì§„ì„ ìë™ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.`);
        }

        // Tinder ìŠ¤íƒ€ì¼ ì¹´ë“œ ì´ˆê¸°í™”
        function initializeTinderCards() {
            const container = document.getElementById('tinderContainer');
            const emptyState = document.getElementById('tinderEmpty');
            
            let photosForTinder = getPhotosForTinder();
            
            if (photosForTinder.length === 0) {
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            container.innerHTML = '';
            tinderCards = [];
            
            // ìµœëŒ€ 3ì¥ì˜ ì¹´ë“œë§Œ í‘œì‹œ (ì„±ëŠ¥ ìµœì í™”)
            const cardsToShow = Math.min(3, photosForTinder.length);
            
            for (let i = 0; i < cardsToShow; i++) {
                const card = createTinderCard(photosForTinder[i], i);
                container.appendChild(card);
                tinderCards.push({
                    element: card,
                    photo: photosForTinder[i],
                    index: i
                });
            }
            
            setupSwipeGestures();
        }

        // Tinder í•„í„°ì— ë”°ë¥¸ ì‚¬ì§„ ê°€ì ¸ì˜¤ê¸°
        function getPhotosForTinder() {
            switch(currentTinderFilter) {
                case 'duplicates':
                    return duplicatePhotos.slice();
                case 'blurry':
                    return blurryPhotos.slice();
                case 'screenshots':
                    return allPhotos.filter(photo => photo.isScreenshot);
                case 'large':
                    return allPhotos.filter(photo => photo.size > 3000000).slice();
                default:
                    return allPhotos.filter(photo => 
                        photo.isDuplicate || photo.isBlurry || photo.isScreenshot || photo.size > 3000000
                    );
            }
        }

        // Tinder ì¹´ë“œ ìƒì„±
        function createTinderCard(photo, index) {
            const card = document.createElement('div');
            card.className = 'tinder-card';
            card.style.zIndex = 10 - index;
            card.style.transform = `scale(${1 - index * 0.05}) translateY(${index * 10}px)`;
            
            card.innerHTML = `
                <img src="${photo.url}" alt="${photo.name}" loading="lazy">
                <div class="tinder-card-info">
                    <h3>${photo.name}</h3>
                    <p>í¬ê¸°: ${(photo.size / 1024 / 1024).toFixed(1)}MB</p>
                    <p>ë‚ ì§œ: ${photo.date.toLocaleDateString()}</p>
                    ${photo.isDuplicate ? '<div class="duplicate-badge">ì¤‘ë³µ</div>' : ''}
                </div>
                <div class="swipe-hint"></div>
            `;
            
            return card;
        }

        // ìŠ¤ì™€ì´í”„ ì œìŠ¤ì²˜ ì„¤ì •
        function setupSwipeGestures() {
            tinderCards.forEach(cardObj => {
                let isDragging = false;
                let startX = 0;
                let startY = 0;
                let currentX = 0;
                let currentY = 0;
                
                const card = cardObj.element;
                const hint = card.querySelector('.swipe-hint');
                
                // í„°ì¹˜ ì´ë²¤íŠ¸
                card.addEventListener('touchstart', handleStart, { passive: false });
                card.addEventListener('touchmove', handleMove, { passive: false });
                card.addEventListener('touchend', handleEnd, { passive: false });
                
                // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
                card.addEventListener('mousedown', handleStart);
                card.addEventListener('mousemove', handleMove);
                card.addEventListener('mouseup', handleEnd);
                
                function handleStart(e) {
                    e.preventDefault();
                    if (cardObj.index !== 0) return; // ë§¨ ì• ì¹´ë“œë§Œ ì¡°ì‘ ê°€ëŠ¥
                    
                    isDragging = true;
                    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                    
                    startX = clientX;
                    startY = clientY;
                    
                    card.style.transition = 'none';
                }
                
                function handleMove(e) {
                    if (!isDragging || cardObj.index !== 0) return;
                    e.preventDefault();
                    
                    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                    
                    currentX = clientX - startX;
                    currentY = clientY - startY;
                    
                    const rotation = currentX * 0.1;
                    card.style.transform = `translateX(${currentX}px) translateY(${currentY}px) rotate(${rotation}deg)`;
                    
                    // íŒíŠ¸ í‘œì‹œ
                    if (Math.abs(currentX) > 50) {
                        if (currentX > 0) {
                            hint.textContent = 'ë³´ê´€';
                            hint.className = 'swipe-hint keep';
                            hint.style.opacity = '1';
                        } else {
                            hint.textContent = 'ì‚­ì œ';
                            hint.className = 'swipe-hint delete';
                            hint.style.opacity = '1';
                        }
                    } else {
                        hint.style.opacity = '0';
                    }
                }
                
                function handleEnd(e) {
                    if (!isDragging || cardObj.index !== 0) return;
                    isDragging = false;
                    
                    const threshold = 100;
                    
                    if (Math.abs(currentX) > threshold) {
                        // ìŠ¤ì™€ì´í”„ ì™„ë£Œ
                        const direction = currentX > 0 ? 'keep' : 'delete';
                        animateCardOut(card, direction, cardObj.photo);
                    } else {
                        // ìŠ¤ì™€ì´í”„ ì·¨ì†Œ
                        card.style.transition = 'transform 0.3s ease';
                        card.style.transform = 'translateX(0) translateY(0) rotate(0deg)';
                        hint.style.opacity = '0';
                    }
                    
                    currentX = 0;
                    currentY = 0;
                }
            });
        }

        // ì¹´ë“œ ì• ë‹ˆë©”ì´ì…˜ ì•„ì›ƒ
        function animateCardOut(card, direction, photo) {
            const translateX = direction === 'keep' ? '100vw' : '-100vw';
            const rotation = direction === 'keep' ? '30deg' : '-30deg';
            
            card.style.transition = 'transform 0.3s ease';
            card.style.transform = `translateX(${translateX}) rotate(${rotation})`;
            
            setTimeout(() => {
                handleSwipeAction(direction, photo);
                updateTinderStack();
            }, 300);
        }

        // ìŠ¤ì™€ì´í”„ ì•¡ì…˜ ì²˜ë¦¬
        function handleSwipeAction(direction, photo) {
            if (direction === 'delete') {
                // íœ´ì§€í†µìœ¼ë¡œ ì´ë™
                trashItems.push(photo);
                
                // ëª¨ë“  ë°°ì—´ì—ì„œ ì œê±°
                allPhotos = allPhotos.filter(p => p.id !== photo.id);
                duplicatePhotos = duplicatePhotos.filter(p => p.id !== photo.id);
                blurryPhotos = blurryPhotos.filter(p => p.id !== photo.id);
                
                showToast('ì‚¬ì§„ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.');
            } else {
                showToast('ì‚¬ì§„ì„ ë³´ê´€í–ˆìŠµë‹ˆë‹¤.');
            }
            
            updateStats();
        }

        // Tinder ìŠ¤íƒ ì—…ë°ì´íŠ¸
        function updateTinderStack() {
            const container = document.getElementById('tinderContainer');
            
            // ì²« ë²ˆì§¸ ì¹´ë“œ ì œê±°
            if (tinderCards.length > 0) {
                container.removeChild(tinderCards[0].element);
                tinderCards.shift();
            }
            
            // ë‚¨ì€ ì¹´ë“œë“¤ ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸
            tinderCards.forEach((cardObj, index) => {
                cardObj.index = index;
                cardObj.element.style.zIndex = 10 - index;
                cardObj.element.style.transition = 'transform 0.3s ease';
                cardObj.element.style.transform = `scale(${1 - index * 0.05}) translateY(${index * 10}px)`;
            });
            
            // ìƒˆ ì¹´ë“œ ì¶”ê°€ (í•„ìš”í•œ ê²½ìš°)
            const photosForTinder = getPhotosForTinder();
            const currentCardCount = tinderCards.length;
            
            if (currentCardCount < 3 && photosForTinder.length > currentCardCount) {
                const newPhoto = photosForTinder[currentCardCount];
                const newCard = createTinderCard(newPhoto, currentCardCount);
                container.appendChild(newCard);
                
                tinderCards.push({
                    element: newCard,
                    photo: newPhoto,
                    index: currentCardCount
                });
            }
            
            // ëª¨ë“  ì¹´ë“œê°€ ì—†ìœ¼ë©´ ì™„ë£Œ ìƒíƒœ í‘œì‹œ
            if (tinderCards.length === 0) {
                document.getElementById('tinderEmpty').style.display = 'block';
            }
            
            // ìƒˆë¡œìš´ ì œìŠ¤ì²˜ ì„¤ì •
            setTimeout(() => {
                setupSwipeGestures();
            }, 300);
        }

        // ë²„íŠ¼ìœ¼ë¡œ ìŠ¤ì™€ì´í”„ ì•¡ì…˜
        function swipeDelete() {
            if (tinderCards.length > 0) {
                const topCard = tinderCards[0];
                animateCardOut(topCard.element, 'delete', topCard.photo);
            }
        }

        function swipeKeep() {
            if (tinderCards.length > 0) {
                const topCard = tinderCards[0];
                animateCardOut(topCard.element, 'keep', topCard.photo);
            }
        }

        // Tinder í•„í„° ì„¤ì •
        function setTinderFilter(filter) {
            currentTinderFilter = filter;
            
            // í•„í„° ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // ì¹´ë“œ ìŠ¤íƒ ì¬ì´ˆê¸°í™”
            initializeTinderCards();
        }

        // íœ´ì§€í†µ í‘œì‹œ
        function displayTrash() {
            const container = document.getElementById('trashItems');
            container.innerHTML = '';
            
            if (trashItems.length === 0) {
                container.innerHTML = '<div class="empty-state"><h3>íœ´ì§€í†µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤</h3><p>ì‚­ì œëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }
            
            trashItems.forEach((photo, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'trash-item';
                itemDiv.innerHTML = `
                    <img src="${photo.url}" alt="${photo.name}">
                    <div class="trash-item-info">
                        <h4>${photo.name}</h4>
                        <p>í¬ê¸°: ${(photo.size / 1024 / 1024).toFixed(1)}MB</p>
                        <p>ì‚­ì œì¼: ${new Date().toLocaleDateString()}</p>
                    </div>
                    <div class="trash-actions">
                        <button class="btn btn-success btn-small" onclick="restorePhoto(${index})">ë³µì›</button>
                        <button class="btn btn-danger btn-small" onclick="permanentDelete(${index})">ì˜êµ¬ì‚­ì œ</button>
                    </div>
                `;
                container.appendChild(itemDiv);
            });
        }

        // ì‚¬ì§„ ë³µì›
        function restorePhoto(index) {
            const photo = trashItems[index];
            allPhotos.push(photo);
            trashItems.splice(index, 1);
            
            updateStats();
            displayTrash();
            showToast('ì‚¬ì§„ì„ ë³µì›í–ˆìŠµë‹ˆë‹¤.');
        }

        // ì˜êµ¬ ì‚­ì œ
        function permanentDelete(index) {
            trashItems.splice(index, 1);
            updateStats();
            displayTrash();
            showToast('ì‚¬ì§„ì„ ì˜êµ¬ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.');
        }

        // ì „ì²´ ë³µì›
        function restoreAllFromTrash() {
            if (trashItems.length === 0) {
                showToast('ë³µì›í•  ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            const count = trashItems.length;
            allPhotos.push(...trashItems);
            trashItems = [];
            
            updateStats();
            displayTrash();
            showToast(`${count}ê°œ ì‚¬ì§„ì„ ëª¨ë‘ ë³µì›í–ˆìŠµë‹ˆë‹¤.`);
        }

        // íœ´ì§€í†µ ë¹„ìš°ê¸°
        function emptyTrash() {
            if (trashItems.length === 0) {
                showToast('íœ´ì§€í†µì´ ì´ë¯¸ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            const count = trashItems.length;
            trashItems = [];
            
            updateStats();
            displayTrash();
            showToast(`${count}ê°œ ì‚¬ì§„ì„ ì˜êµ¬ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.`);
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ë³¸ ë”ë¯¸ ë°ì´í„° ë¡œë“œ (ë°ëª¨ìš©)
            setTimeout(() => {
                loadPhotos().then(() => {
                    findDuplicates();
                    findBlurryPhotos();
                });
            }, 1000);
            
            updateStats();
        });

        // ë°˜ì‘í˜• ì²˜ë¦¬
        window.addEventListener('resize', function() {
            if (document.getElementById('tinder').classList.contains('active')) {
                initializeTinderCards();
            }
        });
    </script>
</body>
</html>